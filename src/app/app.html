<div class="container">
  <div class="header">
    <div class="badge">Angular 21</div>
    <h1>JSON to Excel Converter</h1>
    <p>Convert JSON files to Excel with matching column orders</p>
  </div>

  <div class="content">
    <div class="info-box">
      <h2>How It Works</h2>
      <p>
        This Angular 21 application converts two JSON files into Excel (.xlsx) files with
        perfectly matching column orders. Old File columns are automatically reordered to match
        New File structure for easy comparison.
      </p>
    </div>

    <div class="stats">
      <div class="stat-card">
        <h3>New File (New.json)</h3>
        <div class="stat-number">{{ file1Stats().records }}</div>
        <p>Records with {{ file1Stats().columns }} columns</p>
      </div>

      <div class="stat-card">
        <h3>Old File (Old.json)</h3>
        <div class="stat-number">{{ file2Stats().records }}</div>
        <p>Records with {{ file2Stats().columns }} columns</p>
        <p class="note">Will be reordered to match New File</p>
      </div>
    </div>

    <button class="btn" (click)="convertToExcel()" [disabled]="loading() || !data1().length || !data2().length">
      @if(!loading()) {
      <!-- <span>Download</span> -->
      <span>Convert and Download Excel Files</span>
      }
      @else {
      <span class="spinner"></span>
      <span>Processing...</span>
      }
    </button>

    @if (status()) {
    <div class="status" [ngClass]="statusType()">
      {{ status() }}
    </div>
    }

    @if (columns().length > 0) {
    <div class="preview">
      <h3>Column Order (First 15 of {{ columns().length }} columns)</h3>
      <div class="column-list">
        @for (col of columns().slice(0, 15); track col; let i = $index) {
        <div class="column-item">
          {{ i + 1 }}. {{ col }}
        </div>
        }
        @if (columns().length > 15) {
        <div class="more-columns">
          ... and {{ columns().length - 15 }} more columns
        </div>
        }
      </div>
    </div>
    }
  </div>
</div>